<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理员后台 - K12家校学习资料共享平台</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
        }
        .admin-container {
            display: flex;
            height: 100vh;
        }
        .sidebar {
            width: 250px;
            background: #304156;
            color: white;
            overflow-y: auto;
        }
        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #434a5a;
        }
        .sidebar-header h2 {
            margin: 0;
            font-size: 18px;
        }
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .header {
            height: 60px;
            background: white;
            box-shadow: 0 1px 4px rgba(0,21,41,.08);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
        }
        .content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .login-form {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            width: 400px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #409eff;
            margin-bottom: 8px;
        }
        .stat-label {
            color: #666;
            font-size: 14px;
        }
        .table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .table-header {
            padding: 20px;
            border-bottom: 1px solid #ebeef5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .config-form {
            max-width: 600px;
        }
        .json-editor {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }
        .config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .config-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .config-card-header {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #ebeef5;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .config-card-header h3 {
            margin: 0;
            color: #333;
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        .config-card-header h3 i {
            margin-right: 8px;
            color: #409eff;
        }
        .config-card-content {
            padding: 20px;
        }
        .config-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .config-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .config-label {
            font-weight: 500;
            color: #666;
            min-width: 100px;
        }
        .config-value {
            color: #333;
            font-weight: 600;
        }
        .level-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .level-item {
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #409eff;
        }
        .level-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }
        .level-details {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #666;
        }
        .level-points {
            background: #e1f3d8;
            color: #67c23a;
            padding: 2px 8px;
            border-radius: 4px;
        }
        .level-downloads {
            background: #ecf5ff;
            color: #409eff;
            padding: 2px 8px;
            border-radius: 4px;
        }
        .file-types {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 4px;
        }
        .config-preview {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 4px;
            border: 1px solid #ebeef5;
            max-height: 200px;
            overflow-y: auto;
        }
        .config-preview pre {
            margin: 0;
            font-size: 12px;
            color: #666;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .level-config-container {
            max-height: 500px;
            overflow-y: auto;
        }
        .level-config-item {
            margin-bottom: 16px;
        }
        .level-card {
            border: 1px solid #ebeef5;
        }
        .level-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .form-help {
            font-size: 12px;
            color: #999;
            margin-left: 8px;
            display: block;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- 登录界面 -->
        <div v-if="!isLoggedIn" class="login-container">
            <div class="login-form">
                <h2 style="text-align: center; margin-bottom: 30px; color: #333;">管理员登录</h2>
                <el-form :model="loginForm" :rules="loginRules" ref="loginForm" @submit.native.prevent="login">
                    <el-form-item prop="phone">
                        <el-input v-model="loginForm.phone" placeholder="请输入管理员手机号" prefix-icon="el-icon-phone">
                        </el-input>
                    </el-form-item>
                    <el-form-item prop="password">
                        <el-input v-model="loginForm.password" type="password" placeholder="请输入密码" prefix-icon="el-icon-lock" @keyup.enter.native="login">
                        </el-input>
                    </el-form-item>
                    <el-form-item>
                        <el-button type="primary" @click="login" :loading="loginLoading" style="width: 100%;">
                            登录
                        </el-button>
                    </el-form-item>
                </el-form>
            </div>
        </div>

        <!-- 管理员后台界面 -->
        <div v-else class="admin-container">
            <!-- 侧边栏 -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h2>管理员后台</h2>
                    <p style="margin: 5px 0 0 0; font-size: 12px; opacity: 0.8;">{{ currentUser.nickname }}</p>
                </div>
                <el-menu
                    :default-active="activeMenu"
                    class="sidebar-menu"
                    background-color="#304156"
                    text-color="#bfcbd9"
                    active-text-color="#409eff"
                    @select="handleMenuSelect">
                    <el-menu-item index="dashboard">
                        <i class="el-icon-data-analysis"></i>
                        <span>数据概览</span>
                    </el-menu-item>
                    <el-menu-item index="configs">
                        <i class="el-icon-setting"></i>
                        <span>系统配置</span>
                    </el-menu-item>
                    <el-menu-item index="users">
                        <i class="el-icon-user"></i>
                        <span>用户管理</span>
                    </el-menu-item>
                    <el-menu-item index="resources">
                        <i class="el-icon-folder"></i>
                        <span>资源管理</span>
                    </el-menu-item>
                    <el-menu-item index="logs">
                        <i class="el-icon-document"></i>
                        <span>操作日志</span>
                    </el-menu-item>
                </el-menu>
            </div>

            <!-- 主内容区 -->
            <div class="main-content">
                <!-- 顶部导航 -->
                <div class="header">
                    <h3 style="margin: 0;">{{ menuTitles[activeMenu] || '管理员后台' }}</h3>
                    <div>
                        <el-button type="text" @click="logout">退出登录</el-button>
                    </div>
                </div>

                <!-- 内容区域 -->
                <div class="content">
                    <!-- 数据概览 -->
                    <div v-if="activeMenu === 'dashboard'">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-number">{{ stats.total_users || 0 }}</div>
                                <div class="stat-label">总用户数</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{ stats.active_users || 0 }}</div>
                                <div class="stat-label">活跃用户</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{ stats.total_resources || 0 }}</div>
                                <div class="stat-label">总资源数</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{ stats.total_downloads || 0 }}</div>
                                <div class="stat-label">总下载次数</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{ stats.today_uploads || 0 }}</div>
                                <div class="stat-label">今日上传</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number">{{ stats.today_downloads || 0 }}</div>
                                <div class="stat-label">今日下载</div>
                            </div>
                        </div>
                    </div>

                    <!-- 系统配置 -->
                    <div v-if="activeMenu === 'configs'">
                        <!-- 配置卡片网格 -->
                        <div class="config-grid">
                            <!-- 积分规则配置卡片 -->
                            <div class="config-card">
                                <div class="config-card-header">
                                    <h3><i class="el-icon-coin"></i> 积分规则配置</h3>
                                    <el-button size="small" type="primary" @click="editPointRules">
                                        <i class="el-icon-edit"></i> 编辑
                                    </el-button>
                                </div>
                                <div class="config-card-content">
                                    <div class="config-item" v-if="pointRulesConfig">
                                        <div class="config-row">
                                            <span class="config-label">注册奖励:</span>
                                            <span class="config-value">{{ pointRulesConfig.register_points || 0 }} 积分</span>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">上传奖励:</span>
                                            <span class="config-value">{{ pointRulesConfig.upload_points || 0 }} 积分</span>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">下载消耗:</span>
                                            <span class="config-value">{{ pointRulesConfig.download_cost || 0 }} 积分</span>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">签到奖励:</span>
                                            <span class="config-value">{{ pointRulesConfig.daily_signin_points || 0 }} 积分</span>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">每日下载限制:</span>
                                            <span class="config-value">{{ pointRulesConfig.daily_download_limit || 0 }} 次</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 用户等级配置卡片 -->
                            <div class="config-card">
                                <div class="config-card-header">
                                    <h3><i class="el-icon-user"></i> 用户等级配置</h3>
                                    <el-button size="small" type="primary" @click="editUserLevels">
                                        <i class="el-icon-edit"></i> 编辑
                                    </el-button>
                                </div>
                                <div class="config-card-content">
                                    <div class="level-list" v-if="userLevelsConfig">
                                        <div class="level-item" v-for="(level, name) in userLevelsConfig" :key="name">
                                            <div class="level-name">{{ name }}</div>
                                            <div class="level-details">
                                                <span class="level-points">{{ level.min_points }}-{{ level.max_points === -1 ? '∞' : level.max_points }} 积分</span>
                                                <span class="level-downloads">每日{{ level.daily_downloads }}次下载</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 系统设置配置卡片 -->
                            <div class="config-card">
                                <div class="config-card-header">
                                    <h3><i class="el-icon-setting"></i> 系统基础设置</h3>
                                    <el-button size="small" type="primary" @click="editSystemSettings">
                                        <i class="el-icon-edit"></i> 编辑
                                    </el-button>
                                </div>
                                <div class="config-card-content">
                                    <div class="config-item" v-if="systemSettingsConfig">
                                        <div class="config-row">
                                            <span class="config-label">最大文件大小:</span>
                                            <span class="config-value">{{ formatFileSize(systemSettingsConfig.max_file_size) }}</span>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">允许文件类型:</span>
                                            <div class="file-types">
                                                <el-tag v-for="type in systemSettingsConfig.allowed_file_types" :key="type" size="mini" style="margin: 2px;">
                                                    {{ type.toUpperCase() }}
                                                </el-tag>
                                            </div>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">自动审核资源:</span>
                                            <span class="config-value">
                                                <el-tag :type="systemSettingsConfig.auto_approve_resources ? 'success' : 'danger'" size="mini">
                                                    {{ systemSettingsConfig.auto_approve_resources ? '开启' : '关闭' }}
                                                </el-tag>
                                            </span>
                                        </div>
                                        <div class="config-row">
                                            <span class="config-label">维护模式:</span>
                                            <span class="config-value">
                                                <el-tag :type="systemSettingsConfig.maintenance_mode ? 'warning' : 'success'" size="mini">
                                                    {{ systemSettingsConfig.maintenance_mode ? '维护中' : '正常' }}
                                                </el-tag>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- 其他配置卡片 -->
                            <div class="config-card" v-for="config in otherConfigs" :key="config.id">
                                <div class="config-card-header">
                                    <h3><i class="el-icon-document"></i> {{ config.description || config.config_key }}</h3>
                                    <div>
                                        <el-button size="small" @click="editOtherConfig(config)">
                                            <i class="el-icon-edit"></i> 编辑
                                        </el-button>
                                        <el-button size="small" type="danger" @click="deleteConfig(config)">
                                            <i class="el-icon-delete"></i> 删除
                                        </el-button>
                                    </div>
                                </div>
                                <div class="config-card-content">
                                    <div class="config-preview">
                                        <pre>{{ JSON.stringify(config.config_value, null, 2) }}</pre>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 添加新配置按钮 -->
                        <div style="text-align: center; margin-top: 20px;">
                            <el-button type="primary" @click="showConfigDialog()">
                                <i class="el-icon-plus"></i> 添加自定义配置
                            </el-button>
                        </div>
                    </div>

                    <!-- 用户管理 -->
                    <div v-if="activeMenu === 'users'">
                        <div class="table-container">
                            <div class="table-header">
                                <h4 style="margin: 0;">用户管理</h4>
                                <div>
                                    <el-input v-model="userSearch.keyword" placeholder="搜索用户" style="width: 200px; margin-right: 10px;" @keyup.enter.native="loadUsers">
                                        <el-button slot="append" icon="el-icon-search" @click="loadUsers"></el-button>
                                    </el-input>
                                </div>
                            </div>
                            <el-table :data="users" style="width: 100%">
                                <el-table-column prop="phone" label="手机号" width="120"></el-table-column>
                                <el-table-column prop="nickname" label="昵称" width="100"></el-table-column>
                                <el-table-column prop="child_grade" label="年级" width="100"></el-table-column>
                                <el-table-column prop="points" label="积分" width="80"></el-table-column>
                                <el-table-column prop="level" label="等级" width="100"></el-table-column>
                                <el-table-column prop="is_active" label="状态" width="80">
                                    <template slot-scope="scope">
                                        <el-tag :type="scope.row.is_active ? 'success' : 'danger'">
                                            {{ scope.row.is_active ? '正常' : '禁用' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="created_at" label="注册时间" width="180">
                                    <template slot-scope="scope">
                                        {{ formatDate(scope.row.created_at) }}
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" width="150">
                                    <template slot-scope="scope">
                                        <el-button size="mini" @click="editUser(scope.row)">编辑</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <div style="padding: 20px; text-align: center;">
                                <el-pagination
                                    @current-change="handleUserPageChange"
                                    :current-page="userPagination.page"
                                    :page-size="userPagination.size"
                                    layout="prev, pager, next"
                                    :total="userPagination.total">
                                </el-pagination>
                            </div>
                        </div>
                    </div>

                    <!-- 资源管理 -->
                    <div v-if="activeMenu === 'resources'">
                        <div class="table-container">
                            <div class="table-header">
                                <h4 style="margin: 0;">资源管理</h4>
                                <div>
                                    <el-input v-model="resourceSearch.keyword" placeholder="搜索资源" style="width: 200px; margin-right: 10px;" @keyup.enter.native="loadResources">
                                        <el-button slot="append" icon="el-icon-search" @click="loadResources"></el-button>
                                    </el-input>
                                </div>
                            </div>
                            <el-table :data="resources" style="width: 100%">
                                <el-table-column prop="title" label="标题" width="200"></el-table-column>
                                <el-table-column prop="grade" label="年级" width="100"></el-table-column>
                                <el-table-column prop="subject" label="科目" width="100"></el-table-column>
                                <el-table-column prop="file_type" label="类型" width="80"></el-table-column>
                                <el-table-column prop="download_count" label="下载次数" width="100"></el-table-column>
                                <el-table-column prop="is_active" label="状态" width="80">
                                    <template slot-scope="scope">
                                        <el-tag :type="scope.row.is_active ? 'success' : 'danger'">
                                            {{ scope.row.is_active ? '正常' : '已删除' }}
                                        </el-tag>
                                    </template>
                                </el-table-column>
                                <el-table-column prop="created_at" label="上传时间" width="180">
                                    <template slot-scope="scope">
                                        {{ formatDate(scope.row.created_at) }}
                                    </template>
                                </el-table-column>
                                <el-table-column label="操作" width="200">
                                    <template slot-scope="scope">
                                        <el-button size="mini" @click="editResource(scope.row)">编辑</el-button>
                                        <el-button size="mini" type="danger" @click="deleteResource(scope.row)" v-if="scope.row.is_active">删除</el-button>
                                    </template>
                                </el-table-column>
                            </el-table>
                            <div style="padding: 20px; text-align: center;">
                                <el-pagination
                                    @current-change="handleResourcePageChange"
                                    :current-page="resourcePagination.page"
                                    :page-size="resourcePagination.size"
                                    layout="prev, pager, next"
                                    :total="resourcePagination.total">
                                </el-pagination>
                            </div>
                        </div>
                    </div>

                    <!-- 操作日志 -->
                    <div v-if="activeMenu === 'logs'">
                        <div class="table-container">
                            <div class="table-header">
                                <h4 style="margin: 0;">操作日志</h4>
                            </div>
                            <el-table :data="logs" style="width: 100%">
                                <el-table-column prop="action_type" label="操作类型" width="120"></el-table-column>
                                <el-table-column prop="action_description" label="操作描述"></el-table-column>
                                <el-table-column prop="target_type" label="目标类型" width="100"></el-table-column>
                                <el-table-column prop="ip_address" label="IP地址" width="120"></el-table-column>
                                <el-table-column prop="created_at" label="操作时间" width="180">
                                    <template slot-scope="scope">
                                        {{ formatDate(scope.row.created_at) }}
                                    </template>
                                </el-table-column>
                            </el-table>
                            <div style="padding: 20px; text-align: center;">
                                <el-pagination
                                    @current-change="handleLogPageChange"
                                    :current-page="logPagination.page"
                                    :page-size="logPagination.size"
                                    layout="prev, pager, next"
                                    :total="logPagination.total">
                                </el-pagination>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 积分规则配置对话框 -->
        <el-dialog title="积分规则配置" :visible.sync="pointRulesDialog.visible" width="600px">
            <el-form :model="pointRulesForm" ref="pointRulesForm" label-width="120px">
                <el-form-item label="注册奖励积分">
                    <el-input-number v-model="pointRulesForm.register_points" :min="0" :max="1000" controls-position="right"></el-input-number>
                    <span class="form-help">用户注册时获得的积分奖励</span>
                </el-form-item>
                <el-form-item label="上传奖励积分">
                    <el-input-number v-model="pointRulesForm.upload_points" :min="0" :max="1000" controls-position="right"></el-input-number>
                    <span class="form-help">用户上传资源时获得的积分奖励</span>
                </el-form-item>
                <el-form-item label="下载消耗积分">
                    <el-input-number v-model="pointRulesForm.download_cost" :min="0" :max="1000" controls-position="right"></el-input-number>
                    <span class="form-help">用户下载资源时消耗的积分</span>
                </el-form-item>
                <el-form-item label="签到奖励积分">
                    <el-input-number v-model="pointRulesForm.daily_signin_points" :min="0" :max="1000" controls-position="right"></el-input-number>
                    <span class="form-help">用户每日签到获得的积分奖励</span>
                </el-form-item>
                <el-form-item label="每日下载限制">
                    <el-input-number v-model="pointRulesForm.daily_download_limit" :min="1" :max="100" controls-position="right"></el-input-number>
                    <span class="form-help">用户每日最多可下载的资源数量</span>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="pointRulesDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="savePointRules" :loading="pointRulesDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 用户等级配置对话框 -->
        <el-dialog title="用户等级配置" :visible.sync="userLevelsDialog.visible" width="800px">
            <div class="level-config-container">
                <div class="level-config-item" v-for="(level, index) in userLevelsFormList" :key="index">
                    <el-card class="level-card">
                        <div slot="header" class="level-card-header">
                            <span>{{ level.name }}</span>
                            <el-button type="text" @click="removeLevelConfig(index)" v-if="userLevelsFormList.length > 1">
                                <i class="el-icon-delete"></i>
                            </el-button>
                        </div>
                        <el-form :model="level" label-width="100px">
                            <el-row :gutter="20">
                                <el-col :span="12">
                                    <el-form-item label="等级名称">
                                        <el-input v-model="level.name" placeholder="如：新手用户"></el-input>
                                    </el-form-item>
                                </el-col>
                                <el-col :span="12">
                                    <el-form-item label="每日下载次数">
                                        <el-input-number v-model="level.daily_downloads" :min="1" :max="100" controls-position="right"></el-input-number>
                                    </el-form-item>
                                </el-col>
                            </el-row>
                            <el-row :gutter="20">
                                <el-col :span="12">
                                    <el-form-item label="最低积分">
                                        <el-input-number v-model="level.min_points" :min="0" controls-position="right"></el-input-number>
                                    </el-form-item>
                                </el-col>
                                <el-col :span="12">
                                    <el-form-item label="最高积分">
                                        <el-input-number v-model="level.max_points" :min="-1" controls-position="right"></el-input-number>
                                        <span class="form-help">-1 表示无上限</span>
                                    </el-form-item>
                                </el-col>
                            </el-row>
                        </el-form>
                    </el-card>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <el-button @click="addLevelConfig">
                        <i class="el-icon-plus"></i> 添加等级
                    </el-button>
                </div>
            </div>
            <div slot="footer">
                <el-button @click="userLevelsDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveUserLevels" :loading="userLevelsDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 系统设置配置对话框 -->
        <el-dialog title="系统基础设置" :visible.sync="systemSettingsDialog.visible" width="600px">
            <el-form :model="systemSettingsForm" ref="systemSettingsForm" label-width="120px">
                <el-form-item label="最大文件大小">
                    <el-select v-model="systemSettingsForm.max_file_size" style="width: 200px;">
                        <el-option label="10MB" :value="10485760"></el-option>
                        <el-option label="20MB" :value="20971520"></el-option>
                        <el-option label="50MB" :value="52428800"></el-option>
                        <el-option label="100MB" :value="104857600"></el-option>
                        <el-option label="200MB" :value="209715200"></el-option>
                    </el-select>
                    <span class="form-help">用户上传文件的最大大小限制</span>
                </el-form-item>
                <el-form-item label="允许文件类型">
                    <el-checkbox-group v-model="systemSettingsForm.allowed_file_types">
                        <el-checkbox label="pdf">PDF</el-checkbox>
                        <el-checkbox label="doc">DOC</el-checkbox>
                        <el-checkbox label="docx">DOCX</el-checkbox>
                        <el-checkbox label="ppt">PPT</el-checkbox>
                        <el-checkbox label="pptx">PPTX</el-checkbox>
                        <el-checkbox label="xls">XLS</el-checkbox>
                        <el-checkbox label="xlsx">XLSX</el-checkbox>
                        <el-checkbox label="jpg">JPG</el-checkbox>
                        <el-checkbox label="jpeg">JPEG</el-checkbox>
                        <el-checkbox label="png">PNG</el-checkbox>
                        <el-checkbox label="gif">GIF</el-checkbox>
                        <el-checkbox label="txt">TXT</el-checkbox>
                        <el-checkbox label="zip">ZIP</el-checkbox>
                        <el-checkbox label="rar">RAR</el-checkbox>
                    </el-checkbox-group>
                    <div class="form-help">用户可以上传的文件类型</div>
                </el-form-item>
                <el-form-item label="自动审核资源">
                    <el-switch v-model="systemSettingsForm.auto_approve_resources" active-text="开启" inactive-text="关闭"></el-switch>
                    <div class="form-help">是否自动审核通过用户上传的资源</div>
                </el-form-item>
                <el-form-item label="维护模式">
                    <el-switch v-model="systemSettingsForm.maintenance_mode" active-text="维护中" inactive-text="正常"></el-switch>
                    <div class="form-help">开启后用户将无法正常使用系统</div>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="systemSettingsDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveSystemSettings" :loading="systemSettingsDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 自定义配置编辑对话框 -->
        <el-dialog :title="configDialog.title" :visible.sync="configDialog.visible" width="600px">
            <el-form :model="configForm" :rules="configRules" ref="configForm" class="config-form">
                <el-form-item label="配置键" prop="config_key">
                    <el-input v-model="configForm.config_key" :disabled="configDialog.isEdit"></el-input>
                </el-form-item>
                <el-form-item label="配置描述" prop="description">
                    <el-input v-model="configForm.description"></el-input>
                </el-form-item>
                <el-form-item label="配置值" prop="config_value">
                    <el-input v-model="configValueText" type="textarea" :rows="8" class="json-editor" placeholder="请输入JSON格式的配置值"></el-input>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="configDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveConfig" :loading="configDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 用户编辑对话框 -->
        <el-dialog title="编辑用户" :visible.sync="userDialog.visible" width="500px">
            <el-form :model="userForm" ref="userForm">
                <el-form-item label="积分">
                    <el-input-number v-model="userForm.points" :min="0"></el-input-number>
                </el-form-item>
                <el-form-item label="等级">
                    <el-select v-model="userForm.level" style="width: 100%;">
                        <el-option label="新手用户" value="新手用户"></el-option>
                        <el-option label="活跃用户" value="活跃用户"></el-option>
                        <el-option label="资深用户" value="资深用户"></el-option>
                        <el-option label="专家用户" value="专家用户"></el-option>
                    </el-select>
                </el-form-item>
                <el-form-item label="状态">
                    <el-switch v-model="userForm.is_active" active-text="正常" inactive-text="禁用"></el-switch>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="userDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveUser" :loading="userDialog.loading">保存</el-button>
            </div>
        </el-dialog>

        <!-- 资源编辑对话框 -->
        <el-dialog title="编辑资源" :visible.sync="resourceDialog.visible" width="500px">
            <el-form :model="resourceForm" ref="resourceForm">
                <el-form-item label="标题">
                    <el-input v-model="resourceForm.title"></el-input>
                </el-form-item>
                <el-form-item label="描述">
                    <el-input v-model="resourceForm.description" type="textarea" :rows="3"></el-input>
                </el-form-item>
                <el-form-item label="年级">
                    <el-input v-model="resourceForm.grade"></el-input>
                </el-form-item>
                <el-form-item label="科目">
                    <el-input v-model="resourceForm.subject"></el-input>
                </el-form-item>
                <el-form-item label="状态">
                    <el-switch v-model="resourceForm.is_active" active-text="正常" inactive-text="禁用"></el-switch>
                </el-form-item>
            </el-form>
            <div slot="footer">
                <el-button @click="resourceDialog.visible = false">取消</el-button>
                <el-button type="primary" @click="saveResource" :loading="resourceDialog.loading">保存</el-button>
            </div>
        </el-dialog>
    </div>

    <script src="https://unpkg.com/vue@2/dist/vue.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="js/admin.js?v=3"></script>
</body>
</html>
